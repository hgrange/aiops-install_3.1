# https://github.ibm.com/katamari/dev-issue-tracking/issues/4484
# https://github.ibm.com/katamari/dev-issue-tracking/issues/10680
#https://evtmanager-topology-$WAIOPS_NAMESPACE.<yopurcluster>/1.0/topology/swagger
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
# ADAPT VALUES
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
#-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

export ASM_TOPOLOGY_URL="https://<YOUR-evtmanager-topology-ROUTE"
export WAIOPS_NAMESPACE="YOUR-AIOPS-NAMESPACE"


# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# Do Not Edit Below
# ---------------------------------------------------------------------------------------------------------------------------------------------------"
# ---------------------------------------------------------------------------------------------------------------------------------------------------"



echo "***************************************************************************************************************************************************"
echo "***************************************************************************************************************************************************"
echo "***************************************************************************************************************************************************"
echo "***************************************************************************************************************************************************"
echo "  "
echo "  🚀 CloudPak for Watson AI OPS V3.1.1- Delete Topology for specific Observer"
echo "  "
echo "***************************************************************************************************************************************************"
echo "***************************************************************************************************************************************************"
echo "***************************************************************************************************************************************************"
echo "  "
echo "  "






export ASM_TENANTID="cfd95b7e-3bc7-4006-a4a8-a73a79c71255"

export ASM_USERNAME=$(oc -n $WAIOPS_NAMESPACE get secret evtmanager-topology-asm-credentials -o jsonpath='{.data.username}' | base64 --decode)
export ASM_PASSWORD=$(oc -n $WAIOPS_NAMESPACE get secret evtmanager-topology-asm-credentials -o jsonpath='{.data.password}' | base64 --decode)



echo "  ---------------------------------------------------------------------------------------------------------------------"
echo "  🔍 Your configuration"
echo "  ---------------------------------------------------------------------------------------------------------------------"
echo "     🧍‍♂️ ASM_USERNAME :          $ASM_USERNAME"
echo "     🔐 ASM_PASSWORD :          $ASM_PASSWORD"
echo "     📥 ASM_TENANTID :          $ASM_TENANTID"
echo "     🌏 ASM_TOPOLOGY_URL :      $ASM_TOPOLOGY_URL"
echo "  ---------------------------------------------------------------------------------------------------------------------"



python3 ./delete_ASM_resources.py



echo "----------------------------------------------------------------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------------------------------------------------------------"
echo " ✅ CloudPak for Watson AI OPS V3.1.1- Delete Topology for specific Observer. Done..."
echo "----------------------------------------------------------------------------------------------------------------------------------------------------"
echo "----------------------------------------------------------------------------------------------------------------------------------------------------"
echo "***************************************************************************************************************************************************"
echo "***************************************************************************************************************************************************"
